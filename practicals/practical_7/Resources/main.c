//********************************************************************
//*                    MEC4126F C template                           *
//*==================================================================*
//* WRITTEN BY: Jesse Arendse   	                 	             *
//* DATE CREATED: 07/04/2023                                         *
//* MODIFIED: Dylan Fanner                                           *
//* DATE MODIFIED: 23/01/2025                                        *
//*==================================================================*
//* PROGRAMMED IN: Visual Studio Code                                *
//* TARGET:        STM32F0                                           *
//*==================================================================*
//* DESCRIPTION:     Template for MEC4126F C Practicals              *
//*                                                                  *
//********************************************************************
// INCLUDE FILES
//====================================================================

#define STM32F051

#include "stm32f0xx.h"											   
#include "stdio.h"
#include "stdint.h"

//====================================================================
// GLOBAL CONSTANTS
//====================================================================


//====================================================================
// GLOBAL VARIABLES
//====================================================================


//====================================================================
// FUNCTION DECLARATIONS
//====================================================================
void set_to_48MHz(void);

//====================================================================
// MAIN FUNCTION
//====================================================================

void main (void)
{
    set_to_48MHz();


    while (1)
    {

    }
}							
// End of main

//====================================================================
// ISR DEFINITIONS
//====================================================================


//====================================================================
// FUNCTION DEFINITIONS
//====================================================================
/*
*   Function to configure system clock to 48 MHz
*/
void set_to_48MHz(void)
{
    if ((RCC->CFGR & RCC_CFGR_SWS) == RCC_CFGR_SWS_PLL)
    {
        RCC->CFGR &= (uint32_t) (~RCC_CFGR_SW);
        while ((RCC->CFGR & RCC_CFGR_SWS) != RCC_CFGR_SWS_HSI);
    }
    RCC->CR &= (uint32_t)(~RCC_CR_PLLON);
    while ((RCC->CR & RCC_CR_PLLRDY) != 0);
    RCC->CFGR = ((RCC->CFGR & (~0x003C0000)) | 0x00280000);
    RCC->CR |= RCC_CR_PLLON;
    while ((RCC->CR & RCC_CR_PLLRDY) == 0);
    RCC->CFGR |= (uint32_t) (RCC_CFGR_SW_PLL);
    while ((RCC->CFGR & RCC_CFGR_SWS) != RCC_CFGR_SWS_PLL);
}


//********************************************************************
// END OF PROGRAM
//********************************************************************